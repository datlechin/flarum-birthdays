(()=>{var t={n:a=>{var o=a&&a.__esModule?()=>a.default:()=>a;return t.d(o,{a:o}),o},d:(a,o)=>{for(var e in o)t.o(o,e)&&!t.o(a,e)&&Object.defineProperty(a,e,{enumerable:!0,get:o[e]})},o:(t,a)=>Object.prototype.hasOwnProperty.call(t,a),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},a={};(()=>{"use strict";t.r(a);const o=flarum.core.compat["forum/app"];var e=t.n(o);const r=flarum.core.compat["common/extend"],n=flarum.core.compat["common/models/User"];var s=t.n(n);const i=flarum.core.compat["common/Model"];var d=t.n(i);const h=flarum.core.compat["forum/components/SignUpModal"];var c=t.n(h);const l=flarum.core.compat["common/components/EditUserModal"];var u=t.n(l);const b=flarum.core.compat["common/components/SettingsPage"];var p=t.n(b);const y=flarum.core.compat["common/components/FieldSet"];var f=t.n(y);const g=flarum.core.compat["common/components/Switch"];var D=t.n(g);const w=flarum.core.compat["common/utils/Stream"];var v=t.n(w);const _=flarum.core.compat["forum/components/UserCard"];var x=t.n(_);const S=flarum.core.compat["common/helpers/icon"];var Y=t.n(S);e().initializers.add("datlechin/flarum-birthdays",(function(){s().prototype.birthday=d().attribute("birthday"),s().prototype.showDobDate=d().attribute("showDobDate"),s().prototype.showDobYear=d().attribute("showDobYear"),(0,r.extend)(x().prototype,"infoItems",(function(t){var a,o,r=this.attrs.user,n=(null==(a=r.preferences())?void 0:a.locale)||e().translator.formatter.locale,s=r.birthday(),i=new Date(s),d={month:"long",day:"numeric",year:"numeric"};if("0000-00-00"!==s&&""!==s){if(r.showDobDate()&&r.showDobYear())o=(new Date).getFullYear()-new Date(s).getFullYear(),s=i.toLocaleDateString(n,d);else{if(!0!==r.showDobDate()||!1!==r.showDobYear())return;s=(s=i.toLocaleDateString(n,d)).split(",")[0]}t.add("birthday",m("[",null,Y()("fas fa-birthday-cake"),m("span",{className:"birthday"},e().translator.trans("datlechin-birthdays.forum.user.birthday_text",{date:s})),r.showDobYear()?m("span",{className:"age"},"(",e().translator.trans("datlechin-birthdays.forum.user.age_text",{age:o}),")"):null))}})),(0,r.extend)(u().prototype,"oninit",(function(){this.birthday=v()(this.attrs.user.birthday())})),(0,r.extend)(u().prototype,"fields",(function(t){t.add("birthday",m("div",{className:"Form-group"},m("label",null,e().translator.trans("datlechin-birthdays.forum.edit_user.birthdays_heading")),m("input",{className:"FormControl",type:"date",bidi:this.birthday})),30)})),(0,r.extend)(u().prototype,"data",(function(t){this.birthday()!==this.attrs.user.birthday()&&(t.birthday=this.birthday())})),(0,r.extend)(c().prototype,"oninit",(function(){e().forum.attribute("setBirthdayOnRegistration")&&(this.birthday=v()(this.attrs.birthday||""))})),(0,r.extend)(c().prototype,"fields",(function(t){e().forum.attribute("setBirthdayOnRegistration")&&t.add("birthday",m("div",{className:"Form-group"},m("input",{className:"FormControl birthday",name:"birthday",type:"date",bidi:this.birthday,disabled:this.loading})),20)})),(0,r.extend)(c().prototype,"submitData",(function(t){e().forum.attribute("setBirthdayOnRegistration")&&(t.birthday=this.birthday())})),(0,r.extend)(p().prototype,"settingsItems",(function(t){var a=this;t.add("birthday",m(f(),{className:"Settings-birthday",label:e().translator.trans("datlechin-birthdays.forum.settings.birthday_heading")},m(D(),{state:this.user.showDobDate(),onchange:function(t){a.showDobDateLoading=!0,a.user.save({showDobDate:t}).then((function(){a.showDobDateLoading=!1,m.redraw()}))},loading:this.showDobDateLoading},e().translator.trans("datlechin-birthdays.forum.settings.show_dob_date_label")),m(D(),{state:this.user.showDobDate()&&this.user.showDobYear(),onchange:function(t){a.showDobYearLoading=!0,a.user.save({showDobYear:t}).then((function(){a.showDobYearLoading=!1,m.redraw()}))},loading:this.showDobYearLoading},e().translator.trans("datlechin-birthdays.forum.settings.show_dob_year_label")),m("span",{className:"helpText"},e().translator.trans("datlechin-birthdays.forum.settings.show_dob_year_help"))))}))}))})(),module.exports=a})();
//# sourceMappingURL=forum.js.map