(()=>{var t={n:o=>{var r=o&&o.__esModule?()=>o.default:()=>o;return t.d(r,{a:r}),r},d:(o,r)=>{for(var a in r)t.o(r,a)&&!t.o(o,a)&&Object.defineProperty(o,a,{enumerable:!0,get:r[a]})},o:(t,o)=>Object.prototype.hasOwnProperty.call(t,o),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},o={};(()=>{"use strict";t.r(o);const r=flarum.core.compat["forum/app"];var a=t.n(r);const n=flarum.core.compat["common/extend"],e=flarum.core.compat["common/models/User"];var i=t.n(e);const s=flarum.core.compat["common/Model"];var c=t.n(s);const d=flarum.core.compat["forum/components/SettingsPage"];var l=t.n(d);const u=flarum.core.compat["forum/components/UserCard"];var p=t.n(u);const h=flarum.core.compat["forum/components/SessionDropdown"];var f=t.n(h);const y=flarum.core.compat["common/components/Button"];var b=t.n(y);const v=flarum.core.compat["common/helpers/icon"];var g=t.n(v);function _(t,o){return _=Object.setPrototypeOf||function(t,o){return t.__proto__=o,t},_(t,o)}const M=flarum.core.compat["common/components/Modal"];var N=t.n(M);const O=flarum.core.compat["common/utils/Stream"];var S=t.n(O),B=function(t){var o,r;function a(){return t.apply(this,arguments)||this}r=t,(o=a).prototype=Object.create(r.prototype),o.prototype.constructor=o,_(o,r);var n=a.prototype;return n.oninit=function(o){t.prototype.oninit.call(this,o),this.birthday=S()(app.session.user.birthday())},n.className=function(){return"ChangeBirthdayModal Modal--small"},n.title=function(){return app.translator.trans("datlechin-birthdays.forum.change_birthday.title")},n.content=function(){return m("div",{className:"Modal-body"},m("div",{className:"Form Form--centered"},m("div",{className:"Form-group"},m("input",{type:"date",name:"birthday",className:"FormControl",bidi:this.birthday,disabled:this.loading})),m("div",{className:"Form-group"},b().component({className:"Button Button--primary Button--block",type:"submit",loading:this.loading},app.translator.trans("datlechin-birthdays.forum.change_birthday.submit_button")))))},n.onsubmit=function(t){var o=this;t.preventDefault(),this.birthday()!==app.session.user.email()?(this.loading=!0,this.alertAttrs=null,app.session.user.save({birthday:this.birthday()},{errorHandler:this.onerror.bind(this)}).then((function(){o.success=!0,o.hide()})).catch((function(){})).then(this.loaded.bind(this))):this.hide()},n.onerror=function(o){401===o.status&&(o.alert.content=app.translator.trans("core.forum.change_email.incorrect_password_message")),t.prototype.onerror.call(this,o)},a}(N());a().initializers.add("datlechin/flarum-birthdays",(function(){i().prototype.birthday=c().attribute("birthday"),(0,n.extend)(l().prototype,"accountItems",(function(t){t.add("changeBirthday",m(b(),{className:"Button",onclick:function(){return a().modal.show(B)}},a().translator.trans("datlechin-birthdays.forum.change_birthday.title")))})),(0,n.extend)(p().prototype,"infoItems",(function(t){var o=this.attrs.user;"0000-00-00"!==o.birthday()&&t.add("birthday",m("[",null,g()("fas fa-birthday-cake"),a().translator.trans("datlechin-birthdays.forum.user.birthday_text",{date:o.birthday()})))})),(0,n.extend)(f().prototype,"items",(function(t){console.log(t),t.add("birthday",m(b(),{icon:"fas fa-birthday-cake",onclick:function(){return a().modal.show(B)}},a().translator.trans("datlechin-birthdays.forum.header.edit_birthday_button")))}))}))})(),module.exports=o})();
//# sourceMappingURL=forum.js.map