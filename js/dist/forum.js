module.exports=function(t){var o={};function a(e){if(o[e])return o[e].exports;var r=o[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=t,a.c=o,a.d=function(t,o,e){a.o(t,o)||Object.defineProperty(t,o,{enumerable:!0,get:e})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,o){if(1&o&&(t=a(t)),8&o)return t;if(4&o&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(a.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&o&&"string"!=typeof t)for(var r in t)a.d(e,r,function(o){return t[o]}.bind(null,r));return e},a.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(o,"a",o),o},a.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},a.p="",a(a.s=15)}([function(t,o){t.exports=flarum.core.compat["forum/app"]},function(t,o){t.exports=flarum.core.compat["common/extend"]},function(t,o){t.exports=flarum.core.compat["common/utils/Stream"]},function(t,o){t.exports=flarum.core.compat["common/components/Button"]},function(t,o){t.exports=flarum.core.compat["common/components/Switch"]},function(t,o){t.exports=flarum.core.compat["common/models/User"]},function(t,o){t.exports=flarum.core.compat["common/Model"]},function(t,o){t.exports=flarum.core.compat["forum/components/SignUpModal"]},function(t,o){t.exports=flarum.core.compat["common/components/EditUserModal"]},,function(t,o){t.exports=flarum.core.compat["forum/components/SettingsPage"]},function(t,o){t.exports=flarum.core.compat["common/components/FieldSet"]},function(t,o){t.exports=flarum.core.compat["forum/components/UserCard"]},function(t,o){t.exports=flarum.core.compat["common/helpers/icon"]},function(t,o){t.exports=flarum.core.compat["common/components/Modal"]},function(t,o,a){"use strict";a.r(o);var e=a(0),r=a.n(e),n=a(1),i=a(5),s=a.n(i),c=a(6),d=a.n(c),u=a(7),l=a.n(u),h=a(8),p=a.n(h),b=a(3),f=a.n(b),y=a(10),g=a.n(y),D=a(11),x=a.n(D),_=a(4),w=a.n(_),v=a(2),O=a.n(v),j=a(12),N=a.n(j),S=a(13),Y=a.n(S);function F(t,o){return(F=Object.setPrototypeOf||function(t,o){return t.__proto__=o,t})(t,o)}var M=a(14),B=function(t){var o,a;function e(){return t.apply(this,arguments)||this}a=t,(o=e).prototype=Object.create(a.prototype),o.prototype.constructor=o,F(o,a);var r=e.prototype;return r.oninit=function(o){t.prototype.oninit.call(this,o),this.birthday=O()(app.session.user.birthday())},r.className=function(){return"ChangeBirthdayModal Modal--small"},r.title=function(){return app.translator.trans("datlechin-birthdays.forum.change_dob.title")},r.content=function(){return m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"Form-group"},m("label",null,app.translator.trans("datlechin-birthdays.forum.change_dob.date_of_birth_text")),m("input",{type:"date",name:"birthday",className:"FormControl",bidi:this.birthday,disabled:this.loading})),m("div",{className:"Form-group"},f.a.component({className:"Button Button--primary",type:"submit",loading:this.loading},app.translator.trans("datlechin-birthdays.forum.change_dob.submit_button")))))},r.onsubmit=function(t){var o=this;t.preventDefault(),this.birthday()!==app.session.user.birthday()?(this.loading=!0,this.alertAttrs=null,app.session.user.save({birthday:this.birthday()},{errorHandler:this.onerror.bind(this)}).then((function(){o.success=!0,o.hide()})).catch((function(){})).then(this.loaded.bind(this))):this.hide()},r.onerror=function(o){t.prototype.onerror.call(this,o)},e}(a.n(M).a);r.a.initializers.add("datlechin/flarum-birthdays",(function(){s.a.prototype.birthday=d.a.attribute("birthday"),s.a.prototype.showDobDate=d.a.attribute("showDobDate"),s.a.prototype.showDobYear=d.a.attribute("showDobYear"),Object(n.extend)(N.a.prototype,"infoItems",(function(t){var o,a,e=this.attrs.user,n=(null==(o=e.preferences())?void 0:o.locale)||r.a.translator.formatter.locale,i=e.birthday(),s=new Date(i),c={month:"long",day:"numeric",year:"numeric"};if("0000-00-00"!==i&&""!==i){if(e.showDobDate()&&e.showDobYear())a=(new Date).getFullYear()-new Date(i).getFullYear(),i=s.toLocaleDateString(n,c);else{if(!0!==e.showDobDate()||!1!==e.showDobYear())return;i=(i=s.toLocaleDateString(n,c)).split(",")[0]}t.add("birthday",m("[",null,Y()("fas fa-birthday-cake"),m("span",{className:"birthday"},r.a.translator.trans("datlechin-birthdays.forum.user.birthday_text",{date:i})),e.showDobYear()?m("span",{className:"age"},"(",r.a.translator.trans("datlechin-birthdays.forum.user.age_text",{age:a}),")"):null))}})),Object(n.extend)(p.a.prototype,"oninit",(function(){this.birthday=O()(this.attrs.user.birthday())})),Object(n.extend)(p.a.prototype,"fields",(function(t){t.add("birthday",m("div",{className:"Form-group"},m("label",null,r.a.translator.trans("datlechin-birthdays.forum.edit_user.dob_heading")),m("input",{className:"FormControl",type:"date",bidi:this.birthday})),30)})),Object(n.extend)(p.a.prototype,"data",(function(t){this.birthday()!==this.attrs.user.birthday()&&(t.birthday=this.birthday())})),Object(n.extend)(l.a.prototype,"oninit",(function(){r.a.forum.attribute("setBirthdayOnRegistration")&&(this.birthday=O()(this.attrs.birthday||""))})),Object(n.extend)(l.a.prototype,"fields",(function(t){r.a.forum.attribute("setBirthdayOnRegistration")&&t.add("birthday",m("div",{className:"Form-group"},m("input",{className:"FormControl birthday",name:"birthday",type:"date",bidi:this.birthday,disabled:this.loading})),20)})),Object(n.extend)(l.a.prototype,"submitData",(function(t){r.a.forum.attribute("setBirthdayOnRegistration")&&(t.birthday=this.birthday())})),Object(n.extend)(g.a.prototype,"settingsItems",(function(t){var o=this;t.add("birthday",m(x.a,{className:"Settings-birthday",label:r.a.translator.trans("datlechin-birthdays.forum.settings.dob_heading")},m(w.a,{state:this.user.showDobDate(),onchange:function(t){o.showDobDateLoading=!0,o.user.save({showDobDate:t}).then((function(){o.showDobDateLoading=!1,m.redraw()}))},loading:this.showDobDateLoading},r.a.translator.trans("datlechin-birthdays.forum.settings.show_dob_date_label")),m(w.a,{state:this.user.showDobDate()&&this.user.showDobYear(),onchange:function(t){o.showDobYearLoading=!0,o.user.save({showDobYear:t}).then((function(){o.showDobYearLoading=!1,m.redraw()}))},loading:this.showDobYearLoading},r.a.translator.trans("datlechin-birthdays.forum.settings.show_dob_year_label")),m("span",{className:"helpText"},r.a.translator.trans("datlechin-birthdays.forum.settings.show_dob_year_help"))))})),Object(n.extend)(g.a.prototype,"accountItems",(function(t){t.add("changeBirthday",m(f.a,{className:"Button",onclick:function(){return r.a.modal.show(B)}},r.a.translator.trans("datlechin-birthdays.forum.settings.change_dob_label")))}))}))}]);
//# sourceMappingURL=forum.js.map