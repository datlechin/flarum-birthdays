(()=>{var t={n:o=>{var a=o&&o.__esModule?()=>o.default:()=>o;return t.d(a,{a}),a},d:(o,a)=>{for(var e in a)t.o(a,e)&&!t.o(o,e)&&Object.defineProperty(o,e,{enumerable:!0,get:a[e]})},o:(t,o)=>Object.prototype.hasOwnProperty.call(t,o),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},o={};(()=>{"use strict";t.r(o);const a=flarum.core.compat["forum/app"];var e=t.n(a);const r=flarum.core.compat["common/extend"],n=flarum.core.compat["common/models/User"];var s=t.n(n);const i=flarum.core.compat["common/Model"];var c=t.n(i);const h=flarum.core.compat["forum/components/SettingsPage"];var l=t.n(h);const d=flarum.core.compat["forum/components/UserCard"];var u=t.n(d);const p=flarum.core.compat["forum/components/SessionDropdown"];var b=t.n(p);const f=flarum.core.compat["common/components/Button"];var y=t.n(f);const D=flarum.core.compat["common/helpers/icon"];var w=t.n(D);function g(t,o){return g=Object.setPrototypeOf||function(t,o){return t.__proto__=o,t},g(t,o)}const v=flarum.core.compat["common/components/Modal"];var _=t.n(v);const Y=flarum.core.compat["common/components/Switch"];var N=t.n(Y);const S=flarum.core.compat["common/utils/Stream"];var x=t.n(S),F=function(t){var o,a;function e(){return t.apply(this,arguments)||this}a=t,(o=e).prototype=Object.create(a.prototype),o.prototype.constructor=o,g(o,a);var r=e.prototype;return r.oninit=function(o){t.prototype.oninit.call(this,o);var a=app.session.user;this.birthday=x()(a.birthday()),this.showDobDate=x()(a.showDobDate()),this.showDobYear=x()(a.showDobYear())},r.className=function(){return"ChangeBirthdayModal Modal--small"},r.title=function(){return app.translator.trans("datlechin-birthdays.forum.change_dob.title")},r.content=function(){return m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"Form-group"},m("label",null,app.translator.trans("datlechin-birthdays.forum.change_dob.date_of_birth_text")),m("input",{type:"date",name:"birthday",className:"FormControl",bidi:this.birthday,disabled:this.loading})),m("div",{className:"Form-group"},N().component({state:this.showDobDate(),onchange:this.showDobDate},app.translator.trans("datlechin-birthdays.forum.change_dob.show_dob_date"))),m("div",{className:"Form-group"},N().component({state:this.showDobDate()&&this.showDobYear(),onchange:this.showDobYear},app.translator.trans("datlechin-birthdays.forum.change_dob.show_dob_year")),m("div",{className:"helpText"},app.translator.trans("datlechin-birthdays.forum.change_dob.show_dob_year_help"))),m("div",{className:"Form-group"},y().component({className:"Button Button--primary",type:"submit",loading:this.loading},app.translator.trans("datlechin-birthdays.forum.change_dob.submit_button")))))},r.onsubmit=function(t){var o=this;t.preventDefault(),this.birthday()!==app.session.user.birthday()||this.showDobDate()!==app.session.user.showDobDate()||this.showDobYear()!==app.session.user.showDobYear()?(this.loading=!0,this.alertAttrs=null,app.session.user.save({birthday:this.birthday(),showDobDate:this.showDobDate(),showDobYear:this.showDobYear()},{errorHandler:this.onerror.bind(this)}).then((function(){o.success=!0,o.hide()})).catch((function(){})).then(this.loaded.bind(this))):this.hide()},r.onerror=function(o){t.prototype.onerror.call(this,o)},e}(_());e().initializers.add("datlechin/flarum-birthdays",(function(){s().prototype.birthday=c().attribute("birthday"),s().prototype.showDobDate=c().attribute("showDobDate"),s().prototype.showDobYear=c().attribute("showDobYear"),(0,r.extend)(l().prototype,"accountItems",(function(t){t.add("changeBirthday",m(y(),{className:"Button",onclick:function(){return e().modal.show(F)}},e().translator.trans("datlechin-birthdays.forum.change_dob.title")))})),(0,r.extend)(u().prototype,"infoItems",(function(t){var o,a,r=this.attrs.user,n=(null==(o=r.preferences())?void 0:o.locale)||e().translator.formatter.locale,s=r.birthday(),i=new Date(s),c={month:"long",day:"numeric",year:"numeric"};if("0000-00-00"!==s){if(r.showDobDate()&&r.showDobYear())a=(new Date).getFullYear()-new Date(s).getFullYear(),s=i.toLocaleDateString(n,c);else{if(!0!==r.showDobDate()||!1!==r.showDobYear())return;s=(s=i.toLocaleDateString(n,c)).split(",")[0]}t.add("birthday",m("[",null,w()("fas fa-birthday-cake"),m("span",{className:"birthday"},e().translator.trans("datlechin-birthdays.forum.user.birthday_text",{date:s})),r.showDobYear()?m("span",{className:"age"},"(",e().translator.trans("datlechin-birthdays.forum.user.age_text",{age:a}),")"):null))}})),(0,r.extend)(b().prototype,"items",(function(t){t.add("birthday",m(y(),{icon:"fas fa-birthday-cake",onclick:function(){return e().modal.show(F)}},e().translator.trans("datlechin-birthdays.forum.header.edit_dob_button")))}))}))})(),module.exports=o})();
//# sourceMappingURL=forum.js.map